CREATE DATABASE COMPANY;
USE COMPANY;
-- 1. CUSTOMER DIMENSION
CREATE TABLE CUSTOMER (
    CUSTOMER_ID INT PRIMARY KEY,
    NAME VARCHAR(40) NOT NULL,
    GENDER VARCHAR(10)
);

INSERT INTO CUSTOMER VALUES
(1, 'Archit Konde', 'MALE'),
(2, 'Saakshi Deokar', 'FEMALE'),
(3, 'Hasan Rizvi', 'MALE'),
(4, 'Mega Modha', 'FEMALE'),
(5, 'Mayuresh Phansikar', 'MALE'),
(6, 'Injila Hussain', 'FEMALE');

-- 2. PRODUCT DIMENSION
CREATE TABLE PRODUCT (
    PRODUCT_ID INT PRIMARY KEY,
    PRODUCT_NAME VARCHAR(50),
    CATEGORY VARCHAR(30)
);

INSERT INTO PRODUCT VALUES
(1, 'Laptop', 'Electronics'),
(2, 'Mobile', 'Electronics'),
(3, 'Shirt', 'Clothing'),
(4, 'Shoes', 'Footwear'),
(5, 'Watch', 'Accessories');

-- 3. REGION DIMENSION
CREATE TABLE REGION (
    REGION_ID INT PRIMARY KEY,
    COUNTRY VARCHAR(30),
    STATE VARCHAR(30),
    CITY VARCHAR(30)
);

INSERT INTO REGION VALUES
(1, 'India', 'Maharashtra', 'Mumbai'),
(2, 'India', 'Delhi', 'New Delhi'),
(3, 'India', 'Karnataka', 'Bangalore'),
(4, 'India', 'Gujarat', 'Ahmedabad');

-- 4. TIME DIMENSION
CREATE TABLE TIME (
    TIME_ID INT PRIMARY KEY,
    DAY INT,
    MONTH VARCHAR(15),
    YEAR INT
);

INSERT INTO TIME VALUES
(1, 10, 'January', 2024),
(2, 15, 'February', 2024),
(3, 20, 'March', 2024),
(4, 5, 'April', 2024);

-- 5. FACT TABLE: SALES
CREATE TABLE SALES (
    SALES_ID INT PRIMARY KEY,
    CUSTOMER_ID INT,
    PRODUCT_ID INT,
    REGION_ID INT,
    TIME_ID INT,
    AMOUNT DECIMAL(10,2),
    FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER(CUSTOMER_ID),
    FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCT(PRODUCT_ID),
    FOREIGN KEY (REGION_ID) REFERENCES REGION(REGION_ID),
    FOREIGN KEY (TIME_ID) REFERENCES TIME(TIME_ID)
);

INSERT INTO SALES VALUES
(1, 1, 1, 1, 1, 50000),
(2, 2, 2, 2, 2, 30000),
(3, 3, 3, 3, 3, 2000),
(4, 4, 4, 4, 4, 4000),
(5, 5, 1, 2, 2, 55000),
(6, 6, 2, 3, 3, 32000),
(7, 1, 5, 1, 1, 10000);

-- 1. SLICE: View sales for a specific month (February)
SELECT T.MONTH, SUM(S.AMOUNT) AS TOTAL_SALES
FROM SALES S
JOIN TIME T ON S.TIME_ID = T.TIME_ID
WHERE T.MONTH = 'February'
GROUP BY T.MONTH;

-- 2. DICE: View total sales for selected products and regions
SELECT P.CATEGORY, R.STATE, SUM(S.AMOUNT) AS TOTAL_SALES
FROM SALES S
JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID
JOIN REGION R ON S.REGION_ID = R.REGION_ID
WHERE P.CATEGORY IN ('Electronics', 'Footwear')
  AND R.STATE IN ('Maharashtra', 'Delhi')
GROUP BY P.CATEGORY, R.STATE;

-- 3. ROLL-UP: Aggregate sales from city -> state -> country
SELECT R.COUNTRY, R.STATE, SUM(S.AMOUNT) AS TOTAL_SALES
FROM SALES S
JOIN REGION R ON S.REGION_ID = R.REGION_ID
GROUP BY R.COUNTRY, R.STATE WITH ROLLUP;

-- 4. DRILL-DOWN: Detailed view from year -> month -> day
SELECT T.YEAR, T.MONTH, T.DAY, SUM(S.AMOUNT) AS TOTAL_SALES
FROM SALES S
JOIN TIME T ON S.TIME_ID = T.TIME_ID
GROUP BY T.YEAR, T.MONTH, T.DAY
ORDER BY T.YEAR, T.MONTH, T.DAY;

-- 5. PIVOT: Compare sales by gender for each product category
SELECT P.CATEGORY,
       SUM(CASE WHEN C.GENDER = 'MALE' THEN S.AMOUNT ELSE 0 END) AS MALE_SALES,
       SUM(CASE WHEN C.GENDER = 'FEMALE' THEN S.AMOUNT ELSE 0 END) AS FEMALE_SALES
FROM SALES S
JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID
JOIN CUSTOMER C ON S.CUSTOMER_ID = C.CUSTOMER_ID
GROUP BY P.CATEGORY;
